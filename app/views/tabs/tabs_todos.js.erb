$('.flash_error').empty();
$(".flash_notice").empty();
var tab = $("li.active").children("a").attr("href")
jQuery.fn.todo_pr_date_select = function(){
		this.change(function(){
  $('.spinning').show();
  var time = this.value
  var url = $(this).attr("data-url");
  var id = $(this).attr("data-id");
  $.get("/todo_range", {time: time, url:url, id:id})
  
  });
  };
  
  		
 
<% if @range %>
	$("#not_done_tasks").empty().append("<%= j( render @not_done_todos)  %>")
	$("#done_tasks").empty().append("<%= j( render @done_todos)  %>")
	$(".todo_range_date").datepicker({ 
		onSelect: function() {
			$('#todo_range_form').submit();
  		}
  		}).attr( 'readOnly' , 'true' )
  		
<% else %>
$(tab).empty().append("<%= j( render :partial => "todos/listing_todos")  %>")
	$(".todo_range_date").datepicker({ 
		onSelect: function() {
			$('#todo_range_form').submit();
  		}
  		}).attr( 'readOnly' , 'true' )
  	
	
	
<% end %>
$('.date_format_setter').set_date_format()
$("#dialog_todo").UIdialogs_links();
$(".searchableTaskCustomer").chosen({width: '369px'});
$("select#todos_pr_date_select").todo_pr_date_select();
$(".small_selector").chosen({width:'200px'});
$(".open_todo_update").UIdialogs_edit_links();
jQuery.fn.submitDoneWithAjax = function(id) {
   $.post("/todos/" + id, $(this).serialize(), null, "script");
};
$(".done_box").on("click", function() { 
  	 var id = $(this).attr("id")
  	 $("#edit_done_todo_" + id).submitDoneWithAjax(id)
  });

$(".logs_pluss").click(function() {
 	$(".flash_notice").empty() 
 	$(".spinning").show();
 	$(this).hide()
 	$(this).next(".logs_minus").show()
  	var id = $(this).attr("id")	
  	$.get("/get_logs_todo/" + id)
  });
   
 $(".logs_minus").click(function() {
 	$(".flash_notice").empty() 
 	var id = $(this).attr("id")
 	$("#todo_logs_"+ id ).slideUp()
 	$("#todo_logs_"+ id ).children().empty().remove()
 	$(this).hide()
 	$(this).prev(".logs_pluss").show()
  });
$(".tasks_percent").countDone() 
$(".spinning").hide()